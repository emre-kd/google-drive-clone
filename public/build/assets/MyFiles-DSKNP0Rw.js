import{o as n,f as c,b as e,Q as $,T as A,j as v,d as _,a as r,w,F as S,c as B,u as p,n as I,k as H,l as T,h as R,m as Z,p as K,q as O,g as M,O as L,i as j,t as y,e as G}from"./app-B-nztPtg.js";import{s as U,a as E,e as Q,O as J,A as W}from"./AuthenticatedLayout-Bx_ieomf.js";import{h as X,_ as Y,a as ee}from"./http-helper-DjScDh2K.js";import{_ as V}from"./Checkbox-BT4UPlW1.js";import{_ as te}from"./ConfirmationDialog-DcUkoatk.js";import{_ as le}from"./DownloadFilesButton-C9ppu_bB.js";import{_ as se,a as ae}from"./SecondaryButton-DkfOyd5y.js";import{_ as oe,a as ne,b as re}from"./TextInput-s5tYKQhs.js";import{P as ie}from"./PrimaryButton-B3wwABLf.js";import"./ApplicationLogo-B0l23eNf.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DangerButton-BJoHs5xd.js";function de(m,x){return n(),c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M9.293 2.293a1 1 0 0 1 1.414 0l7 7A1 1 0 0 1 17 11h-1v6a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-6H3a1 1 0 0 1-.707-1.707l7-7Z","clip-rule":"evenodd"})])}const ce=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})],-1),ue={__name:"DeleteFilesButton",props:{deleteAll:{type:Boolean,default:!1,required:!1},deleteIds:{type:Array,required:!1}},emits:["delete"],setup(m,{emit:x}){const t=$(),i=A({all:null,ids:[],parent_id:null}),a=v(!1),u=m,f=x;function o(){if(!u.deleteAll&&!u.deleteIds.length){U("Please select at least one file to delete");return}a.value=!0}function h(){a.value=!1}function g(){i.parent_id=t.props.folder.id,u.deleteAll?i.all=!0:i.ids=u.deleteIds,i.delete(route("file.delete"),{onSuccess:()=>{a.value=!1,f("delete"),E("Selected files have been deleted")}})}return(b,k)=>(n(),c(S,null,[e("button",{onClick:o,class:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white"},[ce,_(" Delete ")]),r(te,{show:a.value,message:"Are you sure want to delete selected files? ",onCancel:h,onConfirm:g},{default:w(()=>[_(" Confirm ")]),_:1},8,["show"])],64))}},me={class:"p-6"},fe=e("h2",{class:"text-lg font-medium text-gray-900"},"Share Files",-1),he={class:"mt-6"},pe={class:"mt-6 flex justify-end"},xe={__name:"ShareFilesModal",props:{modelValue:Boolean,allSelected:Boolean,selectedIds:Array},emits:["update:modelValue"],setup(m,{emit:x}){const t=A({email:null,all:!1,ids:[],parent_id:null}),i=$(),a=v(null),u=m,f=x;function o(){T(()=>a.value.focus())}function h(){t.parent_id=i.props.folder.id,u.allSelected?(t.all=!0,t.ids=[]):t.ids=u.selectedIds;const b=t.email;t.post(route("file.share"),{preserveScroll:!0,onSuccess:()=>{g(),t.reset(),E(`Selected files will be shared to "${b}" if the emails exists in the system`)},onError:()=>a.value.focus()})}function g(){f("update:modelValue"),t.clearErrors(),t.reset()}return(b,k)=>(n(),B(ae,{show:u.modelValue,onShow:o,"max-width":"sm"},{default:w(()=>[e("div",me,[fe,e("div",he,[r(oe,{for:"shareEmail",value:"Enter Email Address ",class:"sr-only"}),r(ne,{type:"text",ref_key:"emailInput",ref:a,id:"shareEmail",modelValue:p(t).email,"onUpdate:modelValue":k[0]||(k[0]=F=>p(t).email=F),class:I(["mt-1 block w-full",p(t).errors.email?"border-red-500 focus:border-red-500 focus:ring-red-500":""]),placeholder:"Enter Email Addresss ",onKeyup:H(h,["enter"])},null,8,["modelValue","class"]),r(re,{message:p(t).errors.email,class:"mt-2"},null,8,["message"])]),e("div",pe,[r(se,{onClick:g},{default:w(()=>[_("Cancel")]),_:1}),r(ie,{class:I(["ml-3",{"opacity-25":p(t).processing}]),onClick:h,disable:p(t).processing},{default:w(()=>[_(" Submit ")]),_:1},8,["class","disable"])])])]),_:1},8,["show"]))}},ve=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{"fill-rule":"evenodd",d:"M15.75 4.5a3 3 0 11.825 2.066l-8.421 4.679a3.002 3.002 0 010 1.51l8.421 4.679a3 3 0 11-.729 1.31l-8.421-4.678a3 3 0 110-4.132l8.421-4.679a3 3 0 01-.096-.755z","clip-rule":"evenodd"})],-1),_e={__name:"ShareFilesButton",props:{allSelected:{type:Boolean,required:!1,default:!1},selectedIds:{type:Array,required:!1}},emits:["restore"],setup(m,{emit:x}){$(),A({all:null,ids:[],parent_id:null});const t=v(!1),i=m;function a(){if(!i.allSelected&&!i.selectedIds.length){U("Please select at least one file to share");return}t.value=!0}return(u,f)=>(n(),c(S,null,[e("button",{onClick:a,class:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white mr-3"},[ve,_(" Share ")]),r(xe,{modelValue:t.value,"onUpdate:modelValue":f[0]||(f[0]=o=>t.value=o),"all-selected":m.allSelected,"selected-ids":m.selectedIds},null,8,["modelValue","all-selected","selected-ids"])],64))}},ge={class:"flex items-center justify-between p-1 mb-3"},we={class:"inline-flex items-center space-x-1 md:space-x-3"},ye={key:1,class:"flex items-center"},be=e("svg",{"aria-hidden":"true",class:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1),ke={class:"flex"},Ce={class:"flex items-center mr-3"},Se={class:"flex-1 overflow-auto"},$e={class:"min-w-full"},Fe={class:"bg-gray-100 border-b"},Me={class:"text-sm font-medium text-gray-900 px-6 py-4 text-left w-[30px] max-w-[30px] pr-0"},Ve=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},null,-1),Be=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"}," Name ",-1),Ie={key:0,class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},Ae=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"}," Owner ",-1),Ee=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"}," Last Modified ",-1),De=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"}," Size ",-1),Oe=["onClick","onDblclick"],Le={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 w-[30px] max-w-[30px] pr-0"},je={class:"px-6 py-4 max-w-[40px] text-sm font-medium text-gray-900 text-yellow-500"},Ue=["onClick"],ze={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},Ne=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"},null,-1),Pe=[Ne],qe={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6"},He=e("path",{"fill-rule":"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z","clip-rule":"evenodd"},null,-1),Te=[He],Re={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 flex items-center"},Ze={key:0,class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ke={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ge={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Qe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Je={key:0,class:"py-8 text-center text-sm text-gray-400"},dt={__name:"MyFiles",props:{files:Object,folder:Object,ancestors:Object},setup(m){$();const x=m,t=v(!1),i=v(!1),a=v({}),u=v(null);let f=v("");const o=v({data:x.files.data,next:x.files.links.next});let h=null;const g=R(()=>Object.entries(a.value).filter(s=>s[1]).map(s=>s[0]));function b(s){s.is_folder&&L.visit(route("myFiles",{folder:s.path}))}function k(){console.log("load more"),console.log(o.value.next),o.value.next!==null&&X(o.value.next).then(s=>{o.value.data=[...o.value.data,...s.data],o.value.next=s.links.next})}function F(){o.value.data.forEach(s=>{a.value[s.id]=t.value})}function z(s){a.value[s.id]=!a.value[s.id],D(s)}function D(s){if(!a.value[s.id])t.value=!1;else{let d=!0;for(let l of o.value.data)if(!a.value[l.id]){d=!1;break}t.value=d}}function N(){t.value=!1,a.value={}}function P(s){ee(route("file.addToFavourites"),{id:s.id}).then(()=>{s.is_favourite=!s.is_favourite,E("Selected file have been added to favourites")}).catch(async d=>{console.log(d)})}function q(){i.value?h.set("favourites",1):h.delete("favourites"),L.get(window.location.pathname+"?"+h.toString())}return Z(()=>{o.value={data:x.files.data,next:x.files.links.next}}),K(()=>{h=new URLSearchParams(window.location.search),i.value=h.get("favourites")==="1",f.value=h.get("search"),Q.on(J,d=>{f.value=d}),new IntersectionObserver(d=>d.forEach(l=>l.isIntersecting&&k()),{rootMargin:"-250px 0px 0px 0px"}).observe(u.value)}),(s,d)=>(n(),B(W,null,{default:w(()=>[e("nav",ge,[e("ol",we,[(n(!0),c(S,null,O(m.ancestors.data,l=>(n(),c("li",{key:l.id,class:"inline-flex items-center"},[l.parent_id?(n(),c("div",ye,[be,r(p(j),{href:s.route("myFiles",{folder:l.path}),class:"ml-1 text-sm font-medium md:ml-2 text-gray-700 hover:text-blue-600"},{default:w(()=>[_(y(l.name),1)]),_:2},1032,["href"])])):(n(),B(p(j),{key:0,href:s.route("myFiles"),class:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600"},{default:w(()=>[r(p(de),{class:"w-4 h-4"}),_(" My Files ")]),_:1},8,["href"]))]))),128))]),e("div",ke,[e("label",Ce,[_(" Only Favourites "),r(V,{onChange:q,checked:i.value,"onUpdate:checked":d[0]||(d[0]=l=>i.value=l),class:"ml-2"},null,8,["checked"])]),r(_e,{"all-selected":t.value,"selected-ids":g.value,class:"mr-2"},null,8,["all-selected","selected-ids"]),r(le,{all:t.value,ids:g.value,class:"mr-2"},null,8,["all","ids"]),r(ue,{"delete-all":t.value,"delete-ids":g.value,onDelete:N},null,8,["delete-all","delete-ids"])])]),e("div",Se,[e("table",$e,[e("thead",Fe,[e("tr",null,[e("th",Me,[r(V,{onChange:F,checked:t.value,"onUpdate:checked":d[1]||(d[1]=l=>t.value=l)},null,8,["checked"])]),Ve,Be,p(f)?(n(),c("th",Ie," Path ")):M("",!0),Ae,Ee,De])]),e("tbody",null,[(n(!0),c(S,null,O(o.value.data,l=>(n(),c("tr",{key:l.id,onClick:C=>z(l),onDblclick:C=>b(l),class:I(["border-b transition duration-900 ease-in-out hover:bg-blue-100 cursor-pointer",a.value[l.id]||t.value?"bg-blue-50":"bg-white"])},[e("td",Le,[r(V,{onChange:C=>D(l),modelValue:a.value[l.id],"onUpdate:modelValue":C=>a.value[l.id]=C,checked:a.value[l.id]||t.value},null,8,["onChange","modelValue","onUpdate:modelValue","checked"])]),e("td",je,[e("div",{onClick:G(C=>P(l),["stop","prevent"])},[l.is_favourite?(n(),c("svg",qe,Te)):(n(),c("svg",ze,Pe))],8,Ue)]),e("td",Re,[r(Y,{file:l},null,8,["file"]),_(" "+y(l.name),1)]),p(f)?(n(),c("td",Ze,y(l.path),1)):M("",!0),e("td",Ke,y(l.owner),1),e("td",Ge,y(l.updated_at),1),e("td",Qe,y(l.size),1)],42,Oe))),128))])]),o.value.data.length?M("",!0):(n(),c("div",Je," There is no data in this folder ")),e("div",{ref_key:"loadMoreIntersect",ref:u},null,512)])]),_:1}))}};export{dt as default};
